{"version":3,"sources":["../../../lib/doc/row.js"],"names":["_","require","Enums","colCache","Cell","Row","module","exports","worksheet","number","_worksheet","_number","_cells","style","outlineLevel","prototype","commit","_commitRow","destroy","findCell","colNumber","getCellEx","address","cell","col","column","getColumn","getCell","getColumnKey","l2n","encodeAddress","row","splice","start","count","inserts","Array","slice","call","arguments","nKeep","nExpand","length","nEnd","i","cSrc","cDst","value","undefined","eachCell","options","iteratee","includeEmpty","n","forEach","index","type","ValueType","Null","addPageBreak","lft","rght","ws","left","Math","max","right","pb","id","man","min","rowBreaks","push","values","offset","hasOwnProperty","item","eachColumnKey","key","hasValues","some","cellCount","actualCellCount","dimensions","_applyStyle","name","numFmt","font","alignment","border","fill","hidden","_hidden","_outlineLevel","collapsed","properties","outlineLevelRow","model","cells","cellModel","height","Error","previousAddress","Types","Merge","decodeAddress","$col$row","n2l","JSON","parse","stringify"],"mappings":"AAAA;;AAEA,IAAMA,IAAIC,QAAQ,qBAAR,CAAV;;AAEA,IAAMC,QAAQD,QAAQ,SAAR,CAAd;AACA,IAAME,WAAWF,QAAQ,sBAAR,CAAjB;AACA,IAAMG,OAAOH,QAAQ,QAAR,CAAb;;AAEA,IAAMI,MAAMC,OAAOC,OAAP,GAAiB,UAAUC,SAAV,EAAqBC,MAArB,EAA6B;AACxD,OAAKC,UAAL,GAAkBF,SAAlB;AACA,OAAKG,OAAL,GAAeF,MAAf;AACA,OAAKG,MAAL,GAAc,EAAd;AACA,OAAKC,KAAL,GAAa,EAAb;AACA,OAAKC,YAAL,GAAoB,CAApB;AACD,CAND;;AAQAT,IAAIU,SAAJ,GAAgB;AACd;AACA,MAAIN,MAAJ,GAAa;AACX,WAAO,KAAKE,OAAZ;AACD,GAJa;;AAMd,MAAIH,SAAJ,GAAgB;AACd,WAAO,KAAKE,UAAZ;AACD,GARa;;AAUd;AACA;AACAM,UAAQ,kBAAW;AACjB,SAAKN,UAAL,CAAgBO,UAAhB,CAA2B,IAA3B,EADiB,CACiB;AACnC,GAda;;AAgBd;AACAC,WAAS,mBAAW;AAClB,WAAO,KAAKR,UAAZ;AACA,WAAO,KAAKE,MAAZ;AACA,WAAO,KAAKC,KAAZ;AACD,GArBa;;AAuBdM,YAAU,kBAASC,SAAT,EAAoB;AAC5B,WAAO,KAAKR,MAAL,CAAYQ,YAAY,CAAxB,CAAP;AACD,GAzBa;;AA2Bd;AACAC,aAAW,mBAASC,OAAT,EAAkB;AAC3B,QAAIC,OAAO,KAAKX,MAAL,CAAYU,QAAQE,GAAR,GAAc,CAA1B,CAAX;AACA,QAAI,CAACD,IAAL,EAAW;AACT,UAAME,SAAS,KAAKf,UAAL,CAAgBgB,SAAhB,CAA0BJ,QAAQE,GAAlC,CAAf;AACAD,aAAO,IAAInB,IAAJ,CAAS,IAAT,EAAeqB,MAAf,EAAuBH,QAAQA,OAA/B,CAAP;AACA,WAAKV,MAAL,CAAYU,QAAQE,GAAR,GAAc,CAA1B,IAA+BD,IAA/B;AACD;AACD,WAAOA,IAAP;AACD,GApCa;;AAsCd;AACAI,WAAS,iBAASH,GAAT,EAAc;AACrB,QAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC3B;AACA,UAAMC,SAAS,KAAKf,UAAL,CAAgBkB,YAAhB,CAA6BJ,GAA7B,CAAf;AACA,UAAIC,MAAJ,EAAY;AACVD,cAAMC,OAAOhB,MAAb;AACD,OAFD,MAEO;AACLe,cAAMrB,SAAS0B,GAAT,CAAaL,GAAb,CAAN;AACD;AACF;AACD,WAAO,KAAKZ,MAAL,CAAYY,MAAM,CAAlB,KACL,KAAKH,SAAL,CAAe;AACbC,eAASnB,SAAS2B,aAAT,CAAuB,KAAKnB,OAA5B,EAAqCa,GAArC,CADI;AAEbO,WAAK,KAAKpB,OAFG;AAGba,WAAKA;AAHQ,KAAf,CADF;AAMD,GAvDa;;AAyDd;AACAQ,UAAQ,gBAASC,KAAT,EAAgBC,KAAhB,EAAuB;AAC7B,QAAMC,UAAUC,MAAMrB,SAAN,CAAgBsB,KAAhB,CAAsBC,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC,CAAhB;AACA,QAAMC,QAAQP,QAAQC,KAAtB;AACA,QAAMO,UAAUN,QAAQO,MAAR,GAAiBR,KAAjC;AACA,QAAMS,OAAO,KAAK/B,MAAL,CAAY8B,MAAzB;AACA,QAAIE,UAAJ;AAAA,QAAOC,aAAP;AAAA,QAAaC,aAAb;;AAEA,QAAIL,UAAU,CAAd,EAAiB;AACf;AACA,WAAKG,IAAIX,QAAQE,QAAQO,MAAzB,EAAiCE,KAAKD,IAAtC,EAA4CC,GAA5C,EAAiD;AAC/CE,eAAO,KAAKlC,MAAL,CAAYgC,IAAI,CAAhB,CAAP;AACAC,eAAO,KAAKjC,MAAL,CAAYgC,IAAIH,OAAJ,GAAc,CAA1B,CAAP;AACA,YAAII,IAAJ,EAAU;AACRC,iBAAO,KAAKnB,OAAL,CAAaiB,CAAb,CAAP;AACAE,eAAKC,KAAL,GAAaF,KAAKE,KAAlB;AACAD,eAAKjC,KAAL,GAAagC,KAAKhC,KAAlB;AACD,SAJD,MAIO,IAAIiC,IAAJ,EAAU;AACfA,eAAKC,KAAL,GAAa,IAAb;AACAD,eAAKjC,KAAL,GAAa,EAAb;AACD;AACF;AACF,KAdD,MAcO,IAAI4B,UAAU,CAAd,EAAiB;AACtB;AACA,WAAKG,IAAID,IAAT,EAAeC,KAAKJ,KAApB,EAA2BI,GAA3B,EAAgC;AAC9BC,eAAO,KAAKjC,MAAL,CAAYgC,IAAI,CAAhB,CAAP;AACA,YAAIC,IAAJ,EAAU;AACRC,iBAAO,KAAKnB,OAAL,CAAaiB,IAAIH,OAAjB,CAAP;AACAK,eAAKC,KAAL,GAAaF,KAAKE,KAAlB;AACAD,eAAKjC,KAAL,GAAagC,KAAKhC,KAAlB;AACD,SAJD,MAIO;AACL,eAAKD,MAAL,CAAagC,IAAIH,OAAL,GAAgB,CAA5B,IAAiCO,SAAjC;AACD;AACF;AACF;;AAED;AACA,SAAKJ,IAAI,CAAT,EAAYA,IAAIT,QAAQO,MAAxB,EAAgCE,GAAhC,EAAqC;AACnCE,aAAO,KAAKnB,OAAL,CAAaM,QAAQW,CAArB,CAAP;AACAE,WAAKC,KAAL,GAAaZ,QAAQS,CAAR,CAAb;AACAE,WAAKjC,KAAL,GAAa,EAAb;AACD;AACF,GAnGa;;AAqGd;AACAoC,YAAU,kBAASC,OAAT,EAAkBC,QAAlB,EAA4B;AACpC,QAAI,CAACA,QAAL,EAAe;AACbA,iBAAWD,OAAX;AACAA,gBAAU,IAAV;AACD;AACD,QAAIA,WAAWA,QAAQE,YAAvB,EAAqC;AACnC,UAAMC,IAAI,KAAKzC,MAAL,CAAY8B,MAAtB;AACA,WAAK,IAAIE,IAAI,CAAb,EAAgBA,KAAKS,CAArB,EAAwBT,GAAxB,EAA6B;AAC3BO,iBAAS,KAAKxB,OAAL,CAAaiB,CAAb,CAAT,EAA0BA,CAA1B;AACD;AACF,KALD,MAKO;AACL,WAAKhC,MAAL,CAAY0C,OAAZ,CAAoB,UAAS/B,IAAT,EAAegC,KAAf,EAAsB;AACxC,YAAIhC,QAASA,KAAKiC,IAAL,KAActD,MAAMuD,SAAN,CAAgBC,IAA3C,EAAkD;AAChDP,mBAAS5B,IAAT,EAAegC,QAAQ,CAAvB;AACD;AACF,OAJD;AAKD;AACF,GAvHa;;AAyHZ;AACF;AACAI,gBAAc,sBAASC,GAAT,EAAcC,IAAd,EAAoB;AAChC,QAAMC,KAAK,KAAKpD,UAAhB;AACA,QAAMqD,OAAOC,KAAKC,GAAL,CAAS,CAAT,EAAYL,MAAM,CAAlB,KAAwB,CAArC;AACA,QAAMM,QAAQF,KAAKC,GAAL,CAAS,CAAT,EAAYJ,OAAO,CAAnB,KAAyB,KAAvC;AACA,QAAMM,KAAK;AACTC,UAAI,KAAKzD,OADA;AAETsD,WAAKC,KAFI;AAGTG,WAAK;AAHI,KAAX;AAKA,QAAIN,IAAJ,EAAUI,GAAGG,GAAH,GAASP,IAAT;;AAEVD,OAAGS,SAAH,CAAaC,IAAb,CAAkBL,EAAlB;AACD,GAvIa;;AAyId;AACA,MAAIM,MAAJ,GAAa;AACX,QAAMA,SAAS,EAAf;AACA,SAAK7D,MAAL,CAAY0C,OAAZ,CAAoB,UAAS/B,IAAT,EAAe;AACjC,UAAIA,QAASA,KAAKiC,IAAL,KAActD,MAAMuD,SAAN,CAAgBC,IAA3C,EAAkD;AAChDe,eAAOlD,KAAKC,GAAZ,IAAmBD,KAAKwB,KAAxB;AACD;AACF,KAJD;AAKA,WAAO0B,MAAP;AACD,GAlJa;;AAoJd;AACA,MAAIA,MAAJ,CAAW1B,KAAX,EAAkB;AAAA;;AAChB;AACA,SAAKnC,MAAL,GAAc,EAAd;AACA,QAAI,CAACmC,KAAL,EAAY;AACV;AACD,KAFD,MAEO,IAAIA,iBAAiBX,KAArB,EAA4B;AACjC,UAAIsC,SAAS,CAAb;AACA,UAAI3B,MAAM4B,cAAN,CAAqB,GAArB,CAAJ,EAA+B;AAC7B;AACAD,iBAAS,CAAT;AACD;AACD3B,YAAMO,OAAN,CAAc,UAACsB,IAAD,EAAOrB,KAAP,EAAiB;AAC7B,YAAIqB,SAAS5B,SAAb,EAAwB;AACtB,gBAAK3B,SAAL,CAAe;AACbC,qBAASnB,SAAS2B,aAAT,CAAuB,MAAKnB,OAA5B,EAAqC4C,QAAQmB,MAA7C,CADI;AAEb3C,iBAAK,MAAKpB,OAFG;AAGba,iBAAK+B,QAAQmB;AAHA,WAAf,EAIG3B,KAJH,GAIW6B,IAJX;AAKD;AACF,OARD;AASD,KAfM,MAeA;AACL;AACA,WAAKlE,UAAL,CAAgBmE,aAAhB,CAA8B,UAACpD,MAAD,EAASqD,GAAT,EAAiB;AAC7C,YAAI/B,MAAM+B,GAAN,MAAe9B,SAAnB,EAA8B;AAC5B,gBAAK3B,SAAL,CAAe;AACbC,qBAASnB,SAAS2B,aAAT,CAAuB,MAAKnB,OAA5B,EAAqCc,OAAOhB,MAA5C,CADI;AAEbsB,iBAAK,MAAKpB,OAFG;AAGba,iBAAKC,OAAOhB;AAHC,WAAf,EAIGsC,KAJH,GAIWA,MAAM+B,GAAN,CAJX;AAKD;AACF,OARD;AASD;AACF,GArLa;;AAuLd;AACA,MAAIC,SAAJ,GAAgB;AACd,WAAO/E,EAAEgF,IAAF,CAAO,KAAKpE,MAAZ,EAAoB,UAASW,IAAT,EAAe;AACxC,aAAOA,QAASA,KAAKiC,IAAL,KAActD,MAAMuD,SAAN,CAAgBC,IAA9C;AACD,KAFM,CAAP;AAGD,GA5La;;AA8Ld,MAAIuB,SAAJ,GAAgB;AACd,WAAO,KAAKrE,MAAL,CAAY8B,MAAnB;AACD,GAhMa;AAiMd,MAAIwC,eAAJ,GAAsB;AACpB,QAAIhD,QAAQ,CAAZ;AACA,SAAKe,QAAL,CAAc,YAAW;AACvBf;AACD,KAFD;AAGA,WAAOA,KAAP;AACD,GAvMa;;AAyMd;AACA,MAAIiD,UAAJ,GAAiB;AACf,QAAIb,MAAM,CAAV;AACA,QAAIL,MAAM,CAAV;AACA,SAAKrD,MAAL,CAAY0C,OAAZ,CAAoB,UAAS/B,IAAT,EAAe;AACjC,UAAIA,QAASA,KAAKiC,IAAL,KAActD,MAAMuD,SAAN,CAAgBC,IAA3C,EAAkD;AAChD,YAAI,CAACY,GAAD,IAASA,MAAM/C,KAAKC,GAAxB,EAA8B;AAC5B8C,gBAAM/C,KAAKC,GAAX;AACD;AACD,YAAIyC,MAAM1C,KAAKC,GAAf,EAAoB;AAClByC,gBAAM1C,KAAKC,GAAX;AACD;AACF;AACF,KATD;AAUA,WAAO8C,MAAM,CAAN,GAAU;AACfA,WAAKA,GADU;AAEfL,WAAKA;AAFU,KAAV,GAGH,IAHJ;AAID,GA3Na;;AA6Nd;AACA;AACAmB,eAAa,qBAASC,IAAT,EAAetC,KAAf,EAAsB;AACjC,SAAKlC,KAAL,CAAWwE,IAAX,IAAmBtC,KAAnB;AACA,SAAKnC,MAAL,CAAY0C,OAAZ,CAAoB,UAAS/B,IAAT,EAAe;AACjC,UAAIA,IAAJ,EAAU;AAAEA,aAAK8D,IAAL,IAAatC,KAAb;AAAqB;AAClC,KAFD;AAGA,WAAOA,KAAP;AACD,GArOa;;AAuOd,MAAIuC,MAAJ,GAAa;AACX,WAAO,KAAKzE,KAAL,CAAWyE,MAAlB;AACD,GAzOa;AA0Od,MAAIA,MAAJ,CAAWvC,KAAX,EAAkB;AAChB,SAAKqC,WAAL,CAAiB,QAAjB,EAA2BrC,KAA3B;AACD,GA5Oa;AA6Od,MAAIwC,IAAJ,GAAW;AACT,WAAO,KAAK1E,KAAL,CAAW0E,IAAlB;AACD,GA/Oa;AAgPd,MAAIA,IAAJ,CAASxC,KAAT,EAAgB;AACd,SAAKqC,WAAL,CAAiB,MAAjB,EAAyBrC,KAAzB;AACD,GAlPa;AAmPd,MAAIyC,SAAJ,GAAgB;AACd,WAAO,KAAK3E,KAAL,CAAW2E,SAAlB;AACD,GArPa;AAsPd,MAAIA,SAAJ,CAAczC,KAAd,EAAqB;AACnB,SAAKqC,WAAL,CAAiB,WAAjB,EAA8BrC,KAA9B;AACD,GAxPa;AAyPd,MAAI0C,MAAJ,GAAa;AACX,WAAO,KAAK5E,KAAL,CAAW4E,MAAlB;AACD,GA3Pa;AA4Pd,MAAIA,MAAJ,CAAW1C,KAAX,EAAkB;AAChB,SAAKqC,WAAL,CAAiB,QAAjB,EAA2BrC,KAA3B;AACD,GA9Pa;AA+Pd,MAAI2C,IAAJ,GAAW;AACT,WAAO,KAAK7E,KAAL,CAAW6E,IAAlB;AACD,GAjQa;AAkQd,MAAIA,IAAJ,CAAS3C,KAAT,EAAgB;AACd,SAAKqC,WAAL,CAAiB,MAAjB,EAAyBrC,KAAzB;AACD,GApQa;;AAsQd,MAAI4C,MAAJ,GAAa;AACX,WAAO,CAAC,CAAC,KAAKC,OAAd;AACD,GAxQa;AAyQd,MAAID,MAAJ,CAAW5C,KAAX,EAAkB;AAChB,SAAK6C,OAAL,GAAe7C,KAAf;AACD,GA3Qa;;AA6Qd,MAAIjC,YAAJ,GAAmB;AACjB,WAAO,KAAK+E,aAAL,IAAsB,CAA7B;AACD,GA/Qa;AAgRd,MAAI/E,YAAJ,CAAiBiC,KAAjB,EAAwB;AACtB,SAAK8C,aAAL,GAAqB9C,KAArB;AACD,GAlRa;AAmRd,MAAI+C,SAAJ,GAAgB;AACd,WAAO,CAAC,EAAE,KAAKD,aAAL,IAAuB,KAAKA,aAAL,IAAsB,KAAKnF,UAAL,CAAgBqF,UAAhB,CAA2BC,eAA1E,CAAR;AACD,GArRa;;AAuRd;AACA,MAAIC,KAAJ,GAAY;AACV,QAAMC,QAAQ,EAAd;AACA,QAAI5B,MAAM,CAAV;AACA,QAAIL,MAAM,CAAV;AACA,SAAKrD,MAAL,CAAY0C,OAAZ,CAAoB,UAAS/B,IAAT,EAAe;AACjC,UAAIA,IAAJ,EAAU;AACR,YAAM4E,YAAY5E,KAAK0E,KAAvB;AACA,YAAIE,SAAJ,EAAe;AACb,cAAI,CAAC7B,GAAD,IAASA,MAAM/C,KAAKC,GAAxB,EAA8B;AAC5B8C,kBAAM/C,KAAKC,GAAX;AACD;AACD,cAAIyC,MAAM1C,KAAKC,GAAf,EAAoB;AAClByC,kBAAM1C,KAAKC,GAAX;AACD;AACD0E,gBAAM1B,IAAN,CAAW2B,SAAX;AACD;AACF;AACF,KAbD;;AAeA,WAAQ,KAAKC,MAAL,IAAeF,MAAMxD,MAAtB,GAAgC;AACrCwD,aAAOA,KAD8B;AAErCzF,cAAQ,KAAKA,MAFwB;AAGrC6D,WAAKA,GAHgC;AAIrCL,WAAKA,GAJgC;AAKrCmC,cAAQ,KAAKA,MALwB;AAMrCvF,aAAO,KAAKA,KANyB;AAOrC8E,cAAQ,KAAKA,MAPwB;AAQrC7E,oBAAc,KAAKA,YARkB;AASrCgF,iBAAW,KAAKA;AATqB,KAAhC,GAUH,IAVJ;AAWD,GAtTa;AAuTd,MAAIG,KAAJ,CAAUlD,KAAV,EAAiB;AAAA;;AACf,QAAIA,MAAMtC,MAAN,KAAiB,KAAKE,OAA1B,EAAmC;AACjC,YAAM,IAAI0F,KAAJ,CAAU,6BAAV,CAAN;AACD;AACD,SAAKzF,MAAL,GAAc,EAAd;AACA,QAAI0F,wBAAJ;AACAvD,UAAMmD,KAAN,CAAY5C,OAAZ,CAAoB,qBAAa;AAC/B,cAAQ6C,UAAU3C,IAAlB;AACE,aAAKpD,KAAKmG,KAAL,CAAWC,KAAhB;AACE;AACA;AACF;AACE,cAAIlF,gBAAJ;AACA,cAAI6E,UAAU7E,OAAd,EAAuB;AACrBA,sBAAUnB,SAASsG,aAAT,CAAuBN,UAAU7E,OAAjC,CAAV;AACD,WAFD,MAEO,IAAIgF,eAAJ,EAAqB;AAC1B;AACA;AACA,gBAAMvE,MAAMuE,gBAAgBvE,GAA5B;AACA,gBAAMP,MAAM8E,gBAAgB9E,GAAhB,GAAsB,CAAlC;AACAF,sBAAU;AACRS,mBAAKA,GADG;AAERP,mBAAKA,GAFG;AAGRF,uBAASnB,SAAS2B,aAAT,CAAuBC,GAAvB,EAA4BP,GAA5B,CAHD;AAIRkF,wBAAU,MAAMvG,SAASwG,GAAT,CAAanF,GAAb,CAAN,GAA0B,GAA1B,GAAgCO;AAJlC,aAAV;AAMD;AACDuE,4BAAkBhF,OAAlB;AACA,cAAMC,OAAO,OAAKF,SAAL,CAAeC,OAAf,CAAb;AACAC,eAAK0E,KAAL,GAAaE,SAAb;AACA;AAvBJ;AAyBD,KA1BD;;AA4BA,QAAIpD,MAAMqD,MAAV,EAAkB;AAChB,WAAKA,MAAL,GAAcrD,MAAMqD,MAApB;AACD,KAFD,MAEO;AACL,aAAO,KAAKA,MAAZ;AACD;;AAED,SAAKT,MAAL,GAAc5C,MAAM4C,MAApB;AACA,SAAK7E,YAAL,GAAoBiC,MAAMjC,YAAN,IAAsB,CAA1C;;AAEA,SAAKD,KAAL,GAAakC,MAAMlC,KAAN,IAAe+F,KAAKC,KAAL,CAAWD,KAAKE,SAAL,CAAe/D,MAAMlC,KAArB,CAAX,CAAf,IAA0D,EAAvE;AACD;AAnWa,CAAhB","file":"row.js","sourcesContent":["'use strict';\n\nconst _ = require('../utils/under-dash');\n\nconst Enums = require('./enums');\nconst colCache = require('./../utils/col-cache');\nconst Cell = require('./cell');\n\nconst Row = module.exports = function (worksheet, number) {\n  this._worksheet = worksheet;\n  this._number = number;\n  this._cells = [];\n  this.style = {};\n  this.outlineLevel = 0;\n};\n\nRow.prototype = {\n  // return the row number\n  get number() {\n    return this._number;\n  },\n\n  get worksheet() {\n    return this._worksheet;\n  },\n\n  // Inform Streaming Writer that this row (and all rows before it) are complete\n  // and ready to write. Has no effect on Worksheet document\n  commit: function() {\n    this._worksheet._commitRow(this); // eslint-disable-line no-underscore-dangle\n  },\n\n  // helps GC by breaking cyclic references\n  destroy: function() {\n    delete this._worksheet;\n    delete this._cells;\n    delete this.style;\n  },\n\n  findCell: function(colNumber) {\n    return this._cells[colNumber - 1];\n  },\n\n  // given {address, row, col}, find or create new cell\n  getCellEx: function(address) {\n    let cell = this._cells[address.col - 1];\n    if (!cell) {\n      const column = this._worksheet.getColumn(address.col);\n      cell = new Cell(this, column, address.address);\n      this._cells[address.col - 1] = cell;\n    }\n    return cell;\n  },\n\n  // get cell by key, letter or column number\n  getCell: function(col) {\n    if (typeof col === 'string') {\n      // is it a key?\n      const column = this._worksheet.getColumnKey(col);\n      if (column) {\n        col = column.number;\n      } else {\n        col = colCache.l2n(col);\n      }\n    }\n    return this._cells[col - 1] ||\n      this.getCellEx({\n        address: colCache.encodeAddress(this._number, col),\n        row: this._number,\n        col: col\n      });\n  },\n\n  // remove cell(s) and shift all higher cells down by count\n  splice: function(start, count) {\n    const inserts = Array.prototype.slice.call(arguments, 2);\n    const nKeep = start + count;\n    const nExpand = inserts.length - count;\n    const nEnd = this._cells.length;\n    let i, cSrc, cDst;\n\n    if (nExpand < 0) {\n      // remove cells\n      for (i = start + inserts.length; i <= nEnd; i++) {\n        cDst = this._cells[i - 1];\n        cSrc = this._cells[i - nExpand - 1];\n        if (cSrc) {\n          cDst = this.getCell(i);\n          cDst.value = cSrc.value;\n          cDst.style = cSrc.style;\n        } else if (cDst) {\n          cDst.value = null;\n          cDst.style = {};\n        }\n      }\n    } else if (nExpand > 0) {\n      // insert new cells\n      for (i = nEnd; i >= nKeep; i--) {\n        cSrc = this._cells[i - 1];\n        if (cSrc) {\n          cDst = this.getCell(i + nExpand);\n          cDst.value = cSrc.value;\n          cDst.style = cSrc.style;\n        } else {\n          this._cells[(i + nExpand) - 1] = undefined;\n        }\n      }\n    }\n\n    // now add the new values\n    for (i = 0; i < inserts.length; i++) {\n      cDst = this.getCell(start + i);\n      cDst.value = inserts[i];\n      cDst.style = {};\n    }\n  },\n\n  // Iterate over all non-null cells in this row\n  eachCell: function(options, iteratee) {\n    if (!iteratee) {\n      iteratee = options;\n      options = null;\n    }\n    if (options && options.includeEmpty) {\n      const n = this._cells.length;\n      for (let i = 1; i <= n; i++) {\n        iteratee(this.getCell(i), i);\n      }\n    } else {\n      this._cells.forEach(function(cell, index) {\n        if (cell && (cell.type !== Enums.ValueType.Null)) {\n          iteratee(cell, index + 1);\n        }\n      });\n    }\n  },\n\n    // ===========================================================================\n  // Page Breaks\n  addPageBreak: function(lft, rght) {\n    const ws = this._worksheet;\n    const left = Math.max(0, lft - 1) || 0;\n    const right = Math.max(0, rght - 1) || 16838;\n    const pb = {\n      id: this._number,\n      max: right,\n      man: 1\n    };\n    if (left) pb.min = left;\n\n    ws.rowBreaks.push(pb);\n  },\n\n  // return a sparse array of cell values\n  get values() {\n    const values = [];\n    this._cells.forEach(function(cell) {\n      if (cell && (cell.type !== Enums.ValueType.Null)) {\n        values[cell.col] = cell.value;\n      }\n    });\n    return values;\n  },\n\n  // set the values by contiguous or sparse array, or by key'd object literal\n  set values(value) {\n    // this operation is not additive - any prior cells are removed\n    this._cells = [];\n    if (!value) {\n      // empty row\n    } else if (value instanceof Array) {\n      let offset = 0;\n      if (value.hasOwnProperty('0')) {\n        // contiguous array - start at column 1\n        offset = 1;\n      }\n      value.forEach((item, index) => {\n        if (item !== undefined) {\n          this.getCellEx({\n            address: colCache.encodeAddress(this._number, index + offset),\n            row: this._number,\n            col: index + offset\n          }).value = item;\n        }\n      });\n    } else {\n      // assume object with column keys\n      this._worksheet.eachColumnKey((column, key) => {\n        if (value[key] !== undefined) {\n          this.getCellEx({\n            address: colCache.encodeAddress(this._number, column.number),\n            row: this._number,\n            col: column.number\n          }).value = value[key];\n        }\n      });\n    }\n  },\n\n  // returns true if the row includes at least one cell with a value\n  get hasValues() {\n    return _.some(this._cells, function(cell) {\n      return cell && (cell.type !== Enums.ValueType.Null);\n    });\n  },\n\n  get cellCount() {\n    return this._cells.length;\n  },\n  get actualCellCount() {\n    let count = 0;\n    this.eachCell(function() {\n      count++;\n    });\n    return count;\n  },\n\n  // get the min and max column number for the non-null cells in this row or null\n  get dimensions() {\n    let min = 0;\n    let max = 0;\n    this._cells.forEach(function(cell) {\n      if (cell && (cell.type !== Enums.ValueType.Null)) {\n        if (!min || (min > cell.col)) {\n          min = cell.col;\n        }\n        if (max < cell.col) {\n          max = cell.col;\n        }\n      }\n    });\n    return min > 0 ? {\n      min: min,\n      max: max\n    } : null;\n  },\n\n  // =========================================================================\n  // styles\n  _applyStyle: function(name, value) {\n    this.style[name] = value;\n    this._cells.forEach(function(cell) {\n      if (cell) { cell[name] = value; }\n    });\n    return value;\n  },\n\n  get numFmt() {\n    return this.style.numFmt;\n  },\n  set numFmt(value) {\n    this._applyStyle('numFmt', value);\n  },\n  get font() {\n    return this.style.font;\n  },\n  set font(value) {\n    this._applyStyle('font', value);\n  },\n  get alignment() {\n    return this.style.alignment;\n  },\n  set alignment(value) {\n    this._applyStyle('alignment', value);\n  },\n  get border() {\n    return this.style.border;\n  },\n  set border(value) {\n    this._applyStyle('border', value);\n  },\n  get fill() {\n    return this.style.fill;\n  },\n  set fill(value) {\n    this._applyStyle('fill', value);\n  },\n\n  get hidden() {\n    return !!this._hidden;\n  },\n  set hidden(value) {\n    this._hidden = value;\n  },\n\n  get outlineLevel() {\n    return this._outlineLevel || 0;\n  },\n  set outlineLevel(value) {\n    this._outlineLevel = value;\n  },\n  get collapsed() {\n    return !!(this._outlineLevel && (this._outlineLevel >= this._worksheet.properties.outlineLevelRow));\n  },\n\n  // =========================================================================\n  get model() {\n    const cells = [];\n    let min = 0;\n    let max = 0;\n    this._cells.forEach(function(cell) {\n      if (cell) {\n        const cellModel = cell.model;\n        if (cellModel) {\n          if (!min || (min > cell.col)) {\n            min = cell.col;\n          }\n          if (max < cell.col) {\n            max = cell.col;\n          }\n          cells.push(cellModel);\n        }\n      }\n    });\n\n    return (this.height || cells.length) ? {\n      cells: cells,\n      number: this.number,\n      min: min,\n      max: max,\n      height: this.height,\n      style: this.style,\n      hidden: this.hidden,\n      outlineLevel: this.outlineLevel,\n      collapsed: this.collapsed\n    } : null;\n  },\n  set model(value) {\n    if (value.number !== this._number) {\n      throw new Error('Invalid row number in model');\n    }\n    this._cells = [];\n    let previousAddress;\n    value.cells.forEach(cellModel => {\n      switch (cellModel.type) {\n        case Cell.Types.Merge:\n          // special case - don't add this types\n          break;\n        default:\n          let address;\n          if (cellModel.address) {\n            address = colCache.decodeAddress(cellModel.address);\n          } else if (previousAddress) {\n            // This is a <c> element without an r attribute\n            // Assume that it's the cell for the next column\n            const row = previousAddress.row;\n            const col = previousAddress.col + 1;\n            address = {\n              row: row,\n              col: col,\n              address: colCache.encodeAddress(row, col),\n              $col$row: '$' + colCache.n2l(col) + '$' + row\n            };\n          }\n          previousAddress = address;\n          const cell = this.getCellEx(address);\n          cell.model = cellModel;\n          break;\n      }\n    });\n\n    if (value.height) {\n      this.height = value.height;\n    } else {\n      delete this.height;\n    }\n\n    this.hidden = value.hidden;\n    this.outlineLevel = value.outlineLevel || 0;\n\n    this.style = value.style && JSON.parse(JSON.stringify(value.style)) || {};\n  }\n};\n"]}