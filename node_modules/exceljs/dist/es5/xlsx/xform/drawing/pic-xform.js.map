{"version":3,"sources":["../../../../../lib/xlsx/xform/drawing/pic-xform.js"],"names":["utils","require","BaseXform","StaticXform","BlipFillXform","NvPicPrXform","spPrJSON","PicXform","module","exports","map","inherits","tag","prepare","model","options","index","render","xmlStream","openNode","closeNode","parseOpen","node","parser","name","reset","parseText","parseClose","mergeModel","undefined"],"mappings":"AAAA;;AAEA,IAAMA,KAAK,GAAGC,OAAO,CAAC,sBAAD,CAArB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAD,CAAzB;;AACA,IAAME,WAAW,GAAGF,OAAO,CAAC,iBAAD,CAA3B;;AAEA,IAAMG,aAAa,GAAGH,OAAO,CAAC,mBAAD,CAA7B;;AACA,IAAMI,YAAY,GAAGJ,OAAO,CAAC,mBAAD,CAA5B;;AAEA,IAAMK,QAAQ,GAAGL,OAAO,CAAC,SAAD,CAAxB;;AAEA,IAAMM,QAAQ,GAAIC,MAAM,CAACC,OAAP,GAAiB,YAAW;AAC5C,OAAKC,GAAL,GAAW;AACT,mBAAe,IAAIL,YAAJ,EADN;AAET,oBAAgB,IAAID,aAAJ,EAFP;AAGT,gBAAY,IAAID,WAAJ,CAAgBG,QAAhB;AAHH,GAAX;AAKD,CAND;;AAQAN,KAAK,CAACW,QAAN,CAAeJ,QAAf,EAAyBL,SAAzB,EAAoC;AAClC,MAAIU,GAAJ,GAAU;AACR,WAAO,SAAP;AACD,GAHiC;;AAKlCC,EAAAA,OALkC,mBAK1BC,KAL0B,EAKnBC,OALmB,EAKV;AACtBD,IAAAA,KAAK,CAACE,KAAN,GAAcD,OAAO,CAACC,KAAR,GAAgB,CAA9B;AACD,GAPiC;AASlCC,EAAAA,MATkC,kBAS3BC,SAT2B,EAShBJ,KATgB,EAST;AACvBI,IAAAA,SAAS,CAACC,QAAV,CAAmB,KAAKP,GAAxB;AAEA,SAAKF,GAAL,CAAS,aAAT,EAAwBO,MAAxB,CAA+BC,SAA/B,EAA0CJ,KAA1C;AACA,SAAKJ,GAAL,CAAS,cAAT,EAAyBO,MAAzB,CAAgCC,SAAhC,EAA2CJ,KAA3C;AACA,SAAKJ,GAAL,CAAS,UAAT,EAAqBO,MAArB,CAA4BC,SAA5B,EAAuCJ,KAAvC;AAEAI,IAAAA,SAAS,CAACE,SAAV;AACD,GAjBiC;AAmBlCC,EAAAA,SAnBkC,qBAmBxBC,IAnBwB,EAmBlB;AACd,QAAI,KAAKC,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,aAAO,IAAP;AACD;;AACD,YAAQA,IAAI,CAACE,IAAb;AACE,WAAK,KAAKZ,GAAV;AACE,aAAKa,KAAL;AACA;;AACF;AACE,aAAKF,MAAL,GAAc,KAAKb,GAAL,CAASY,IAAI,CAACE,IAAd,CAAd;;AACA,YAAI,KAAKD,MAAT,EAAiB;AACf,eAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACD;;AACD;AATJ;;AAWA,WAAO,IAAP;AACD,GApCiC;AAsClCI,EAAAA,SAtCkC,uBAsCtB,CAAE,CAtCoB;AAwClCC,EAAAA,UAxCkC,sBAwCvBH,IAxCuB,EAwCjB;AACf,QAAI,KAAKD,MAAT,EAAiB;AACf,UAAI,CAAC,KAAKA,MAAL,CAAYI,UAAZ,CAAuBH,IAAvB,CAAL,EAAmC;AACjC,aAAKI,UAAL,CAAgB,KAAKL,MAAL,CAAYT,KAA5B;AACA,aAAKS,MAAL,GAAcM,SAAd;AACD;;AACD,aAAO,IAAP;AACD;;AACD,YAAQL,IAAR;AACE,WAAK,KAAKZ,GAAV;AACE,eAAO,KAAP;;AACF;AACE;AACA,eAAO,IAAP;AALJ;AAOD;AAvDiC,CAApC","sourcesContent":["'use strict';\n\nconst utils = require('../../../utils/utils');\nconst BaseXform = require('../base-xform');\nconst StaticXform = require('../static-xform');\n\nconst BlipFillXform = require('./blip-fill-xform');\nconst NvPicPrXform = require('./nv-pic-pr-xform');\n\nconst spPrJSON = require('./sp-pr');\n\nconst PicXform = (module.exports = function() {\n  this.map = {\n    'xdr:nvPicPr': new NvPicPrXform(),\n    'xdr:blipFill': new BlipFillXform(),\n    'xdr:spPr': new StaticXform(spPrJSON),\n  };\n});\n\nutils.inherits(PicXform, BaseXform, {\n  get tag() {\n    return 'xdr:pic';\n  },\n\n  prepare(model, options) {\n    model.index = options.index + 1;\n  },\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag);\n\n    this.map['xdr:nvPicPr'].render(xmlStream, model);\n    this.map['xdr:blipFill'].render(xmlStream, model);\n    this.map['xdr:spPr'].render(xmlStream, model);\n\n    xmlStream.closeNode();\n  },\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case this.tag:\n        this.reset();\n        break;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n        }\n        break;\n    }\n    return true;\n  },\n\n  parseText() {},\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.mergeModel(this.parser.model);\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        return false;\n      default:\n        // not quite sure how we get here!\n        return true;\n    }\n  },\n});\n"],"file":"pic-xform.js"}