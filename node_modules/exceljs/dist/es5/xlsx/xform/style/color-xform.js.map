{"version":3,"sources":["../../../../../lib/xlsx/xform/style/color-xform.js"],"names":["utils","require","BaseXform","ColorXform","module","exports","name","inherits","tag","render","xmlStream","model","openNode","argb","addAttribute","theme","undefined","tint","indexed","closeNode","parseOpen","node","attributes","rgb","parseInt","parseFloat","parseText","parseClose"],"mappings":"AAAA;;AAEA,IAAMA,KAAK,GAAGC,OAAO,CAAC,sBAAD,CAArB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAD,CAAzB,C,CAEA;;;AACA,IAAME,UAAU,GAAIC,MAAM,CAACC,OAAP,GAAiB,UAASC,IAAT,EAAe;AAClD;AACA,OAAKA,IAAL,GAAYA,IAAI,IAAI,OAApB;AACD,CAHD;;AAKAN,KAAK,CAACO,QAAN,CAAeJ,UAAf,EAA2BD,SAA3B,EAAsC;AACpC,MAAIM,GAAJ,GAAU;AACR,WAAO,KAAKF,IAAZ;AACD,GAHmC;;AAKpCG,EAAAA,MALoC,kBAK7BC,SAL6B,EAKlBC,KALkB,EAKX;AACvB,QAAIA,KAAJ,EAAW;AACTD,MAAAA,SAAS,CAACE,QAAV,CAAmB,KAAKN,IAAxB;;AACA,UAAIK,KAAK,CAACE,IAAV,EAAgB;AACdH,QAAAA,SAAS,CAACI,YAAV,CAAuB,KAAvB,EAA8BH,KAAK,CAACE,IAApC;AACD,OAFD,MAEO,IAAIF,KAAK,CAACI,KAAN,KAAgBC,SAApB,EAA+B;AACpCN,QAAAA,SAAS,CAACI,YAAV,CAAuB,OAAvB,EAAgCH,KAAK,CAACI,KAAtC;;AACA,YAAIJ,KAAK,CAACM,IAAN,KAAeD,SAAnB,EAA8B;AAC5BN,UAAAA,SAAS,CAACI,YAAV,CAAuB,MAAvB,EAA+BH,KAAK,CAACM,IAArC;AACD;AACF,OALM,MAKA,IAAIN,KAAK,CAACO,OAAN,KAAkBF,SAAtB,EAAiC;AACtCN,QAAAA,SAAS,CAACI,YAAV,CAAuB,SAAvB,EAAkCH,KAAK,CAACO,OAAxC;AACD,OAFM,MAEA;AACLR,QAAAA,SAAS,CAACI,YAAV,CAAuB,MAAvB,EAA+B,GAA/B;AACD;;AACDJ,MAAAA,SAAS,CAACS,SAAV;AACA,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GAxBmC;AA0BpCC,EAAAA,SA1BoC,qBA0B1BC,IA1B0B,EA0BpB;AACd,QAAIA,IAAI,CAACf,IAAL,KAAc,KAAKA,IAAvB,EAA6B;AAC3B,UAAIe,IAAI,CAACC,UAAL,CAAgBC,GAApB,EAAyB;AACvB,aAAKZ,KAAL,GAAa;AAAEE,UAAAA,IAAI,EAAEQ,IAAI,CAACC,UAAL,CAAgBC;AAAxB,SAAb;AACD,OAFD,MAEO,IAAIF,IAAI,CAACC,UAAL,CAAgBP,KAApB,EAA2B;AAChC,aAAKJ,KAAL,GAAa;AAAEI,UAAAA,KAAK,EAAES,QAAQ,CAACH,IAAI,CAACC,UAAL,CAAgBP,KAAjB,EAAwB,EAAxB;AAAjB,SAAb;;AACA,YAAIM,IAAI,CAACC,UAAL,CAAgBL,IAApB,EAA0B;AACxB,eAAKN,KAAL,CAAWM,IAAX,GAAkBQ,UAAU,CAACJ,IAAI,CAACC,UAAL,CAAgBL,IAAjB,CAA5B;AACD;AACF,OALM,MAKA,IAAII,IAAI,CAACC,UAAL,CAAgBJ,OAApB,EAA6B;AAClC,aAAKP,KAAL,GAAa;AAAEO,UAAAA,OAAO,EAAEM,QAAQ,CAACH,IAAI,CAACC,UAAL,CAAgBJ,OAAjB,EAA0B,EAA1B;AAAnB,SAAb;AACD,OAFM,MAEA;AACL,aAAKP,KAAL,GAAaK,SAAb;AACD;;AACD,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GA3CmC;AA4CpCU,EAAAA,SA5CoC,uBA4CxB,CAAE,CA5CsB;AA6CpCC,EAAAA,UA7CoC,wBA6CvB;AACX,WAAO,KAAP;AACD;AA/CmC,CAAtC","sourcesContent":["'use strict';\n\nconst utils = require('../../../utils/utils');\nconst BaseXform = require('../base-xform');\n\n// Color encapsulates translation from color model to/from xlsx\nconst ColorXform = (module.exports = function(name) {\n  // this.name controls the xm node name\n  this.name = name || 'color';\n});\n\nutils.inherits(ColorXform, BaseXform, {\n  get tag() {\n    return this.name;\n  },\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.openNode(this.name);\n      if (model.argb) {\n        xmlStream.addAttribute('rgb', model.argb);\n      } else if (model.theme !== undefined) {\n        xmlStream.addAttribute('theme', model.theme);\n        if (model.tint !== undefined) {\n          xmlStream.addAttribute('tint', model.tint);\n        }\n      } else if (model.indexed !== undefined) {\n        xmlStream.addAttribute('indexed', model.indexed);\n      } else {\n        xmlStream.addAttribute('auto', '1');\n      }\n      xmlStream.closeNode();\n      return true;\n    }\n    return false;\n  },\n\n  parseOpen(node) {\n    if (node.name === this.name) {\n      if (node.attributes.rgb) {\n        this.model = { argb: node.attributes.rgb };\n      } else if (node.attributes.theme) {\n        this.model = { theme: parseInt(node.attributes.theme, 10) };\n        if (node.attributes.tint) {\n          this.model.tint = parseFloat(node.attributes.tint);\n        }\n      } else if (node.attributes.indexed) {\n        this.model = { indexed: parseInt(node.attributes.indexed, 10) };\n      } else {\n        this.model = undefined;\n      }\n      return true;\n    }\n    return false;\n  },\n  parseText() {},\n  parseClose() {\n    return false;\n  },\n});\n"],"file":"color-xform.js"}