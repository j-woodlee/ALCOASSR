{"version":3,"sources":["../../../../../lib/xlsx/xform/core/relationships-xform.js"],"names":["utils","require","XmlStream","BaseXform","RelationshipXform","RelationshipsXform","module","exports","map","Relationship","inherits","RELATIONSHIPS_ATTRIBUTES","xmlns","render","xmlStream","model","_values","openXml","StdDocAttributes","openNode","self","forEach","relationship","closeNode","parseOpen","node","parser","name","Error","JSON","stringify","parseText","text","parseClose","push","undefined"],"mappings":"AAAA;;AAEA,IAAMA,KAAK,GAAGC,OAAO,CAAC,sBAAD,CAArB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,2BAAD,CAAzB;;AACA,IAAME,SAAS,GAAGF,OAAO,CAAC,eAAD,CAAzB;;AAEA,IAAMG,iBAAiB,GAAGH,OAAO,CAAC,sBAAD,CAAjC;;AAEA,IAAMI,kBAAkB,GAAIC,MAAM,CAACC,OAAP,GAAiB,YAAW;AACtD,OAAKC,GAAL,GAAW;AACTC,IAAAA,YAAY,EAAE,IAAIL,iBAAJ;AADL,GAAX;AAGD,CAJD;;AAMAJ,KAAK,CAACU,QAAN,CACEL,kBADF,EAEEF,SAFF,EAGE;AACEQ,EAAAA,wBAAwB,EAAE;AAAEC,IAAAA,KAAK,EAAE;AAAT;AAD5B,CAHF,EAME;AACEC,EAAAA,MADF,kBACSC,SADT,EACoBC,KADpB,EAC2B;AACvBA,IAAAA,KAAK,GAAGA,KAAK,IAAI,KAAKC,OAAtB;AACAF,IAAAA,SAAS,CAACG,OAAV,CAAkBf,SAAS,CAACgB,gBAA5B;AACAJ,IAAAA,SAAS,CAACK,QAAV,CAAmB,eAAnB,EAAoCd,kBAAkB,CAACM,wBAAvD;AAEA,QAAMS,IAAI,GAAG,IAAb;AACAL,IAAAA,KAAK,CAACM,OAAN,CAAc,UAAAC,YAAY,EAAI;AAC5BF,MAAAA,IAAI,CAACZ,GAAL,CAASC,YAAT,CAAsBI,MAAtB,CAA6BC,SAA7B,EAAwCQ,YAAxC;AACD,KAFD;AAIAR,IAAAA,SAAS,CAACS,SAAV;AACD,GAZH;AAcEC,EAAAA,SAdF,qBAcYC,IAdZ,EAckB;AACd,QAAI,KAAKC,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,aAAO,IAAP;AACD;;AACD,YAAQA,IAAI,CAACE,IAAb;AACE,WAAK,eAAL;AACE,aAAKZ,KAAL,GAAa,EAAb;AACA,eAAO,IAAP;;AACF;AACE,aAAKW,MAAL,GAAc,KAAKlB,GAAL,CAASiB,IAAI,CAACE,IAAd,CAAd;;AACA,YAAI,KAAKD,MAAT,EAAiB;AACf,eAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,iBAAO,IAAP;AACD;;AACD,cAAM,IAAIG,KAAJ,6CAA+CC,IAAI,CAACC,SAAL,CAAeL,IAAf,CAA/C,EAAN;AAVJ;AAYD,GA/BH;AAgCEM,EAAAA,SAhCF,qBAgCYC,IAhCZ,EAgCkB;AACd,QAAI,KAAKN,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYK,SAAZ,CAAsBC,IAAtB;AACD;AACF,GApCH;AAqCEC,EAAAA,UArCF,sBAqCaN,IArCb,EAqCmB;AACf,QAAI,KAAKD,MAAT,EAAiB;AACf,UAAI,CAAC,KAAKA,MAAL,CAAYO,UAAZ,CAAuBN,IAAvB,CAAL,EAAmC;AACjC,aAAKZ,KAAL,CAAWmB,IAAX,CAAgB,KAAKR,MAAL,CAAYX,KAA5B;AACA,aAAKW,MAAL,GAAcS,SAAd;AACD;;AACD,aAAO,IAAP;AACD;;AACD,YAAQR,IAAR;AACE,WAAK,eAAL;AACE,eAAO,KAAP;;AACF;AACE,cAAM,IAAIC,KAAJ,8CAAgDD,IAAhD,EAAN;AAJJ;AAMD;AAnDH,CANF","sourcesContent":["'use strict';\n\nconst utils = require('../../../utils/utils');\nconst XmlStream = require('../../../utils/xml-stream');\nconst BaseXform = require('../base-xform');\n\nconst RelationshipXform = require('./relationship-xform');\n\nconst RelationshipsXform = (module.exports = function() {\n  this.map = {\n    Relationship: new RelationshipXform(),\n  };\n});\n\nutils.inherits(\n  RelationshipsXform,\n  BaseXform,\n  {\n    RELATIONSHIPS_ATTRIBUTES: { xmlns: 'http://schemas.openxmlformats.org/package/2006/relationships' },\n  },\n  {\n    render(xmlStream, model) {\n      model = model || this._values;\n      xmlStream.openXml(XmlStream.StdDocAttributes);\n      xmlStream.openNode('Relationships', RelationshipsXform.RELATIONSHIPS_ATTRIBUTES);\n\n      const self = this;\n      model.forEach(relationship => {\n        self.map.Relationship.render(xmlStream, relationship);\n      });\n\n      xmlStream.closeNode();\n    },\n\n    parseOpen(node) {\n      if (this.parser) {\n        this.parser.parseOpen(node);\n        return true;\n      }\n      switch (node.name) {\n        case 'Relationships':\n          this.model = [];\n          return true;\n        default:\n          this.parser = this.map[node.name];\n          if (this.parser) {\n            this.parser.parseOpen(node);\n            return true;\n          }\n          throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(node)}`);\n      }\n    },\n    parseText(text) {\n      if (this.parser) {\n        this.parser.parseText(text);\n      }\n    },\n    parseClose(name) {\n      if (this.parser) {\n        if (!this.parser.parseClose(name)) {\n          this.model.push(this.parser.model);\n          this.parser = undefined;\n        }\n        return true;\n      }\n      switch (name) {\n        case 'Relationships':\n          return false;\n        default:\n          throw new Error(`Unexpected xml node in parseClose: ${name}`);\n      }\n    },\n  }\n);\n"],"file":"relationships-xform.js"}