{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/page-setup-xform.js"],"names":["_","require","utils","BaseXform","booleanToXml","model","undefined","pageOrderToXml","cellCommentsToXml","errorsToXml","pageSizeToModel","value","parseInt","PageSetupXform","module","exports","inherits","tag","render","xmlStream","attributes","paperSize","orientation","horizontalDpi","verticalDpi","pageOrder","blackAndWhite","draft","cellComments","errors","scale","fitToWidth","fitToHeight","firstPageNumber","useFirstPageNumber","usePrinterDefaults","copies","some","leafNode","parseOpen","node","name","parseText","parseClose"],"mappings":"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","sourcesContent":["'use strict';\n\nconst _ = require('../../../utils/under-dash');\nconst utils = require('../../../utils/utils');\nconst BaseXform = require('../base-xform');\n\nfunction booleanToXml(model) {\n  return model ? '1' : undefined;\n}\nfunction pageOrderToXml(model) {\n  switch (model) {\n    case 'overThenDown':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction cellCommentsToXml(model) {\n  switch (model) {\n    case 'atEnd':\n    case 'asDisplyed':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction errorsToXml(model) {\n  switch (model) {\n    case 'dash':\n    case 'blank':\n    case 'NA':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction pageSizeToModel(value) {\n  return value !== undefined ? parseInt(value, 10) : undefined;\n}\n\nconst PageSetupXform = (module.exports = function() {});\n\nutils.inherits(PageSetupXform, BaseXform, {\n  get tag() {\n    return 'pageSetup';\n  },\n\n  render(xmlStream, model) {\n    if (model) {\n      const attributes = {\n        paperSize: model.paperSize,\n        orientation: model.orientation,\n        horizontalDpi: model.horizontalDpi,\n        verticalDpi: model.verticalDpi,\n        pageOrder: pageOrderToXml(model.pageOrder),\n        blackAndWhite: booleanToXml(model.blackAndWhite),\n        draft: booleanToXml(model.draft),\n        cellComments: cellCommentsToXml(model.cellComments),\n        errors: errorsToXml(model.errors),\n        scale: model.scale,\n        fitToWidth: model.fitToWidth,\n        fitToHeight: model.fitToHeight,\n        firstPageNumber: model.firstPageNumber,\n        useFirstPageNumber: booleanToXml(model.firstPageNumber),\n        usePrinterDefaults: booleanToXml(model.usePrinterDefaults),\n        copies: model.copies,\n      };\n      if (_.some(attributes, value => value !== undefined)) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  },\n\n  parseOpen(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          paperSize: pageSizeToModel(node.attributes.paperSize),\n          orientation: node.attributes.orientation || 'portrait',\n          horizontalDpi: parseInt(node.attributes.horizontalDpi || '4294967295', 10),\n          verticalDpi: parseInt(node.attributes.verticalDpi || '4294967295', 10),\n          pageOrder: node.attributes.pageOrder || 'downThenOver',\n          blackAndWhite: node.attributes.blackAndWhite === '1',\n          draft: node.attributes.draft === '1',\n          cellComments: node.attributes.cellComments || 'None',\n          errors: node.attributes.errors || 'displayed',\n          scale: parseInt(node.attributes.scale || '100', 10),\n          fitToWidth: parseInt(node.attributes.fitToWidth || '1', 10),\n          fitToHeight: parseInt(node.attributes.fitToHeight || '1', 10),\n          firstPageNumber: parseInt(node.attributes.firstPageNumber || '1', 10),\n          useFirstPageNumber: node.attributes.useFirstPageNumber === '1',\n          usePrinterDefaults: node.attributes.usePrinterDefaults === '1',\n          copies: parseInt(node.attributes.copies || '1', 10),\n        };\n        return true;\n      default:\n        return false;\n    }\n  },\n  parseText() {},\n  parseClose() {\n    return false;\n  },\n});\n"],"file":"page-setup-xform.js"}